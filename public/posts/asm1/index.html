<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>PicoCTF: ASM1 | 0xtaxyneno</title>
<meta name=keywords content="picoctf,asm"><meta name=description content="Counting in assembly."><meta name=author content="David"><link rel=canonical href=http://localhost:1313/posts/asm1/><link crossorigin=anonymous href=/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/asm1/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="PicoCTF: ASM1"><meta property="og:description" content="Counting in assembly."><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/asm1/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-09-08T00:00:00+00:00"><meta property="article:modified_time" content="2024-09-08T00:00:00+00:00"><meta property="og:site_name" content="0xTaxyneno"><meta name=twitter:card content="summary"><meta name=twitter:title content="PicoCTF: ASM1"><meta name=twitter:description content="Counting in assembly."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"PicoCTF: ASM1","item":"http://localhost:1313/posts/asm1/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PicoCTF: ASM1","name":"PicoCTF: ASM1","description":"Counting in assembly.","keywords":["picoctf","asm"],"articleBody":"Problem Overview We are given an assembly file. We are asked to output what asm1(0x2e0) returns.\nLet’s take a look at the assembly file:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 asm1: \u003c+0\u003e:\tpush ebp \u003c+1\u003e:\tmov ebp,esp \u003c+3\u003e:\tcmp DWORD PTR [ebp+0x8],0x3fb \u003c+10\u003e:\tjg 0x512 \u003c+12\u003e:\tcmp DWORD PTR [ebp+0x8],0x280 \u003c+19\u003e:\tjne 0x50a \u003c+21\u003e:\tmov eax,DWORD PTR [ebp+0x8] \u003c+24\u003e:\tadd eax,0xa \u003c+27\u003e:\tjmp 0x529 \u003c+29\u003e:\tmov eax,DWORD PTR [ebp+0x8] \u003c+32\u003e:\tsub eax,0xa \u003c+35\u003e:\tjmp 0x529 \u003c+37\u003e:\tcmp DWORD PTR [ebp+0x8],0x559 \u003c+44\u003e:\tjne 0x523 \u003c+46\u003e:\tmov eax,DWORD PTR [ebp+0x8] \u003c+49\u003e:\tsub eax,0xa \u003c+52\u003e:\tjmp 0x529 \u003c+54\u003e:\tmov eax,DWORD PTR [ebp+0x8] \u003c+57\u003e:\tadd eax,0xa \u003c+60\u003e:\tpop ebp \u003c+61\u003e:\tret Some quick observations:\nIt looks like we are using Intel syntax It looks like we just need to run through some conditional checks for the given input value. We should focus on jumping to the right labels. Walking Through the Code First Comparison Our input, 0x2e0, is 736 in decimal. I will leave some notes on converted hexadecimal values as we work through the code.\n1 2 3 4 5 6 7 ;; input value to asm1: 736 asm1: \u003c+0\u003e:\tpush ebp \u003c+1\u003e:\tmov ebp,esp \u003c+3\u003e:\tcmp DWORD PTR [ebp+0x8],0x3fb ;; 1019 ;; if the input value is \u003e 1019, jump to 0x512 \u003c+10\u003e:\tjg 0x512 In this first block, we check if the value on the stack is greater than 1019. With our input value of 736, we don’t jump. Instead, we keep walking through the assembly.\nSecond Comparison 1 2 3 \u003c+12\u003e:\tcmp DWORD PTR [ebp+0x8],0x280 ;; 640 ;; if the input value is not equal to 640, jump to 0x50a \u003c+19\u003e:\tjne 0x50a Here, we check if the input is not equal to 640. It actually is not, so let’s jump to 0x50a.\nEAX Shenanigans 1 2 3 \u003c+29\u003e:\tmov eax,DWORD PTR [ebp+0x8] ;; eax = 736 \u003c+32\u003e:\tsub eax,0xa ;; eax = 726 \u003c+35\u003e:\tjmp 0x529 Here, we move the input value, 736, on the stack into the eax register.\nThen, we subtract 10 from eax, leaving its value at 726. Let’s jump to 0x529.\nReturn 1 2 \u003c+60\u003e:\tpop ebp \u003c+61\u003e:\tret Here, we just pop the base pointer and return. After converting 726 from the eax register to hexadecimal, we get 2D6.\nThe CTF asks us to input the value in the format 0x, so the flag is just 0x2D6.\n","wordCount":"418","inLanguage":"en","datePublished":"2024-09-08T00:00:00Z","dateModified":"2024-09-08T00:00:00Z","author":{"@type":"Person","name":"David"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/asm1/"},"publisher":{"@type":"Organization","name":"0xtaxyneno","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="0xTaxyneno (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>0xTaxyneno</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/categories/ title=categories><span>categories</span></a></li><li><a href=http://localhost:1313/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">PicoCTF: ASM1</h1><div class=post-meta><span title='2024-09-08 00:00:00 +0000 UTC'>September 8, 2024</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;David</div></header><div class=post-content><h1 id=problem-overview>Problem Overview<a hidden class=anchor aria-hidden=true href=#problem-overview>#</a></h1><p>We are given an assembly file. We are asked to output what <code>asm1(0x2e0)</code> returns.</p><p>Let&rsquo;s take a look at the assembly file:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>asm1:
</span></span><span class=line><span class=cl>    &lt;+0&gt;:	push   ebp
</span></span><span class=line><span class=cl>    &lt;+1&gt;:	mov    ebp,esp
</span></span><span class=line><span class=cl>    &lt;+3&gt;:	cmp    DWORD PTR [ebp+0x8],0x3fb
</span></span><span class=line><span class=cl>    &lt;+10&gt;:	jg     0x512 &lt;asm1+37&gt;
</span></span><span class=line><span class=cl>    &lt;+12&gt;:	cmp    DWORD PTR [ebp+0x8],0x280
</span></span><span class=line><span class=cl>    &lt;+19&gt;:	jne    0x50a &lt;asm1+29&gt;
</span></span><span class=line><span class=cl>    &lt;+21&gt;:	mov    eax,DWORD PTR [ebp+0x8]
</span></span><span class=line><span class=cl>    &lt;+24&gt;:	add    eax,0xa
</span></span><span class=line><span class=cl>    &lt;+27&gt;:	jmp    0x529 &lt;asm1+60&gt;
</span></span><span class=line><span class=cl>    &lt;+29&gt;:	mov    eax,DWORD PTR [ebp+0x8]
</span></span><span class=line><span class=cl>    &lt;+32&gt;:	sub    eax,0xa
</span></span><span class=line><span class=cl>    &lt;+35&gt;:	jmp    0x529 &lt;asm1+60&gt;
</span></span><span class=line><span class=cl>    &lt;+37&gt;:	cmp    DWORD PTR [ebp+0x8],0x559
</span></span><span class=line><span class=cl>    &lt;+44&gt;:	jne    0x523 &lt;asm1+54&gt;
</span></span><span class=line><span class=cl>    &lt;+46&gt;:	mov    eax,DWORD PTR [ebp+0x8]
</span></span><span class=line><span class=cl>    &lt;+49&gt;:	sub    eax,0xa
</span></span><span class=line><span class=cl>    &lt;+52&gt;:	jmp    0x529 &lt;asm1+60&gt;
</span></span><span class=line><span class=cl>    &lt;+54&gt;:	mov    eax,DWORD PTR [ebp+0x8]
</span></span><span class=line><span class=cl>    &lt;+57&gt;:	add    eax,0xa
</span></span><span class=line><span class=cl>    &lt;+60&gt;:	pop    ebp
</span></span><span class=line><span class=cl>    &lt;+61&gt;:	ret
</span></span></code></pre></td></tr></table></div></div><p>Some quick observations:</p><ol><li>It looks like we are using Intel syntax</li><li>It looks like we just need to run through some conditional checks for the given input value. We should focus on jumping to the right labels.</li></ol><h1 id=walking-through-the-code>Walking Through the Code<a hidden class=anchor aria-hidden=true href=#walking-through-the-code>#</a></h1><h2 id=first-comparison>First Comparison<a hidden class=anchor aria-hidden=true href=#first-comparison>#</a></h2><p>Our input, <code>0x2e0</code>, is 736 in decimal. I will leave some notes on converted hexadecimal values as we work through the code.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>;; input value to asm1: 736
</span></span><span class=line><span class=cl>asm1:
</span></span><span class=line><span class=cl>    &lt;+0&gt;:	push   ebp
</span></span><span class=line><span class=cl>    &lt;+1&gt;:	mov    ebp,esp
</span></span><span class=line><span class=cl>    &lt;+3&gt;:	cmp    DWORD PTR [ebp+0x8],0x3fb ;; 1019
</span></span><span class=line><span class=cl>    ;; if the input value is &gt; 1019, jump to 0x512
</span></span><span class=line><span class=cl>    &lt;+10&gt;:	jg     0x512 &lt;asm1+37&gt;
</span></span></code></pre></td></tr></table></div></div><p>In this first block, we check if the value on the stack is greater than 1019. With our input value of 736, we don&rsquo;t jump. Instead, we keep walking through the assembly.</p><h2 id=second-comparison>Second Comparison<a hidden class=anchor aria-hidden=true href=#second-comparison>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>    &lt;+12&gt;:	cmp    DWORD PTR [ebp+0x8],0x280 ;; 640
</span></span><span class=line><span class=cl>    ;; if the input value is not equal to 640, jump to 0x50a
</span></span><span class=line><span class=cl>    &lt;+19&gt;:	jne    0x50a &lt;asm1+29&gt;
</span></span></code></pre></td></tr></table></div></div><p>Here, we check if the input is not equal to 640. It actually is not, so let&rsquo;s jump to <code>0x50a</code>.</p><h2 id=eax-shenanigans>EAX Shenanigans<a hidden class=anchor aria-hidden=true href=#eax-shenanigans>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>    &lt;+29&gt;:	mov    eax,DWORD PTR [ebp+0x8] ;; eax = 736
</span></span><span class=line><span class=cl>    &lt;+32&gt;:	sub    eax,0xa ;; eax = 726
</span></span><span class=line><span class=cl>    &lt;+35&gt;:	jmp    0x529 &lt;asm1+60&gt;
</span></span></code></pre></td></tr></table></div></div><p>Here, we move the input value, 736, on the stack into the <code>eax</code> register.</p><p>Then, we subtract 10 from <code>eax</code>, leaving its value at 726. Let&rsquo;s jump to <code>0x529</code>.</p><h2 id=return>Return<a hidden class=anchor aria-hidden=true href=#return>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>    &lt;+60&gt;:	pop    ebp
</span></span><span class=line><span class=cl>    &lt;+61&gt;:	ret
</span></span></code></pre></td></tr></table></div></div><p>Here, we just pop the base pointer and return. After converting 726 from the eax register to hexadecimal, we get <code>2D6</code>.</p><p>The CTF asks us to input the value in the format <code>0x&lt;RETURN_VALUE></code>, so the flag is just <code>0x2D6</code>.</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/picoctf/>Picoctf</a></li><li><a href=http://localhost:1313/tags/asm/>Asm</a></li></ul><nav class=paginav><a class=next href=http://localhost:1313/posts/picker1/><span class=title>Next »</span><br><span>PicoCTF: Picker I</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>0xtaxyneno</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>