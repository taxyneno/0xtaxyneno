<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>PicoCTF: Picker I | 0xtaxyneno</title>
<meta name=keywords content="picoctf"><meta name=description content="Using the eval function? Not good."><meta name=author content="David"><link rel=canonical href=http://localhost:1313/posts/picker1/><link crossorigin=anonymous href=/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/picker1/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="PicoCTF: Picker I"><meta property="og:description" content="Using the eval function? Not good."><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/picker1/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-09-08T00:00:00+00:00"><meta property="article:modified_time" content="2024-09-08T00:00:00+00:00"><meta property="og:site_name" content="0xTaxyneno"><meta name=twitter:card content="summary"><meta name=twitter:title content="PicoCTF: Picker I"><meta name=twitter:description content="Using the eval function? Not good."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"PicoCTF: Picker I","item":"http://localhost:1313/posts/picker1/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PicoCTF: Picker I","name":"PicoCTF: Picker I","description":"Using the eval function? Not good.","keywords":["picoctf"],"articleBody":"Investigating the Server When we connect, we are prompted to input getRandomNumber. That works, but what happens if we provide an invalid input?\n1 2 3 4 5 6 7 Try entering \"getRandomNumber\" without the double quotes... ==\u003e getRandomNumber 4 Try entering \"getRandomNumber\" without the double quotes... ==\u003e 4 'int' object is not callable Providing invalid input shows what looks like a Python error message. This suggests that user input might not be sanitized properly. Let’s test if we can provide Python input directly:\n1 2 3 Try entering \"getRandomNumber\" without the double quotes... ==\u003e getRandomNumber(123123) getRandomNumber() takes 0 positional arguments but 1 was given It turns out we can execute Python code! This means that we can now explore the contents of the Python script running on the server.\nSo, let’s try printing the contents of the file with this one liner:\n1 print(open(__file__).read()) And, that outputs the contents of the entire Python script running on the server!\nInvestigating the Python File Parsing through the output, we see this function:\n1 2 3 4 5 6 7 8 9 10 def win(): # This line will not work locally unless you create your own 'flag.txt' in # the same directory as this script flag = open('flag.txt', 'r').read() #flag = flag[:-1] flag = flag.strip() str_flag = '' for c in flag: str_flag += str(hex(ord(c))) + ' ' print(str_flag) Now, we know that flag.txt is being read from the Python script. So, we have two choices:\nOpen flag.txt using arbitrary Python code Reverse the encryption provided in the win() function Opening flag.txt Directly Remember how we read the contents of the servers Python script? Because we know where flag.txt is… we can just open the file path directly.\n1 print(open(\"flag.txt\").read()) This outputs the flag: picoCTF{4_d14m0nd_1n_7h3_r0ugh_ce4b5d5b}\nReversing the Encryption Opening the file directly is too easy! Let’s have some fun.\nAfter executing win() on the server, we get this returned to us:\n1 0x70 0x69 0x63 0x6f 0x43 0x54 0x46 0x7b 0x34 0x5f 0x64 0x31 0x34 0x6d 0x30 0x6e 0x64 0x5f 0x31 0x6e 0x5f 0x37 0x68 0x33 0x5f 0x72 0x30 0x75 0x67 0x68 0x5f 0x63 0x65 0x34 0x62 0x35 0x64 0x35 0x62 0x7d Remember that win() function we discovered in the Python file? It converted each character of the flag into the hex representation of the character’s unicode value (ord(c)):\n1 2 3 ... for c in flag: str_flag += str(hex(ord(c))) + ' ' We simply just need to reverse the operations provided in the above code snippet.\n1 2 3 4 5 6 7 8 9 10 11 12 13 # list comprehensions are super, super nice to know. # https://www.programiz.com/python-programming/list-comprehension # hex string from win() output starting_flag = \"0x70 0x69 0x63 0x6f 0x43 0x54 0x46 0x7b 0x34 0x5f 0x64 0x31 0x34 0x6d 0x30 0x6e 0x64 0x5f 0x31 0x6e 0x5f 0x37 0x68 0x33 0x5f 0x72 0x30 0x75 0x67 0x68 0x5f 0x63 0x65 0x34 0x62 0x35 0x64 0x35 0x62 0x7d\" # split the string into individual hex codes split_flag = starting_flag.split(\" \") # convert each hex code back its original character transformed_flag = \"\".join(chr(int(word, 16)) for word in split_flag) print(transformed_flag) # picoCTF{4_d14m0nd_1n_7h3_r0ugh_ce4b5d5b} ","wordCount":"520","inLanguage":"en","datePublished":"2024-09-08T00:00:00Z","dateModified":"2024-09-08T00:00:00Z","author":{"@type":"Person","name":"David"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/picker1/"},"publisher":{"@type":"Organization","name":"0xtaxyneno","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="0xTaxyneno (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>0xTaxyneno</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/categories/ title=categories><span>categories</span></a></li><li><a href=http://localhost:1313/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">PicoCTF: Picker I</h1><div class=post-meta><span title='2024-09-08 00:00:00 +0000 UTC'>September 8, 2024</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;David</div></header><div class=post-content><h1 id=investigating-the-server>Investigating the Server<a hidden class=anchor aria-hidden=true href=#investigating-the-server>#</a></h1><p>When we connect, we are prompted to input <code>getRandomNumber</code>. That works, but what happens if we provide an invalid input?</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Try entering &#34;getRandomNumber&#34; without the double quotes...
</span></span><span class=line><span class=cl>==&gt; getRandomNumber
</span></span><span class=line><span class=cl>4
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Try entering &#34;getRandomNumber&#34; without the double quotes...
</span></span><span class=line><span class=cl>==&gt; 4
</span></span><span class=line><span class=cl>&#39;int&#39; object is not callable
</span></span></code></pre></td></tr></table></div></div><p>Providing invalid input shows what looks like a Python error message. This suggests that user input might not be sanitized properly. Let&rsquo;s test if we can provide Python input directly:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Try entering &#34;getRandomNumber&#34; without the double quotes...
</span></span><span class=line><span class=cl>==&gt; getRandomNumber(123123)
</span></span><span class=line><span class=cl>getRandomNumber() takes 0 positional arguments but 1 was given
</span></span></code></pre></td></tr></table></div></div><p>It turns out we can execute Python code! This means that we can now explore the contents of the Python script running on the server.</p><p>So, let&rsquo;s try printing the contents of the file with this one liner:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>open</span><span class=p>(</span><span class=vm>__file__</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><p>And, that outputs the contents of the entire Python script running on the server!</p><h1 id=investigating-the-python-file>Investigating the Python File<a hidden class=anchor aria-hidden=true href=#investigating-the-python-file>#</a></h1><p>Parsing through the output, we see this function:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=k>def</span> <span class=nf>win</span><span class=p>():</span>
</span></span><span class=line><span class=cl>  <span class=c1># This line will not work locally unless you create your own &#39;flag.txt&#39; in</span>
</span></span><span class=line><span class=cl>  <span class=c1>#   the same directory as this script</span>
</span></span><span class=line><span class=cl>  <span class=n>flag</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;flag.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=c1>#flag = flag[:-1]</span>
</span></span><span class=line><span class=cl>  <span class=n>flag</span> <span class=o>=</span> <span class=n>flag</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>str_flag</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>flag</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>str_flag</span> <span class=o>+=</span> <span class=nb>str</span><span class=p>(</span><span class=nb>hex</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>c</span><span class=p>)))</span> <span class=o>+</span> <span class=s1>&#39; &#39;</span>
</span></span><span class=line><span class=cl>  <span class=nb>print</span><span class=p>(</span><span class=n>str_flag</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Now, we know that <code>flag.txt</code> is being read from the Python script. So, we have two choices:</p><ol><li>Open <code>flag.txt</code> using arbitrary Python code</li><li>Reverse the encryption provided in the <code>win()</code> function</li></ol><h2 id=opening-flagtxt-directly>Opening flag.txt Directly<a hidden class=anchor aria-hidden=true href=#opening-flagtxt-directly>#</a></h2><p>Remember how we read the contents of the servers Python script? Because we know where <code>flag.txt</code> is&mldr; we can just open the file path directly.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>open</span><span class=p>(</span><span class=s2>&#34;flag.txt&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><p>This outputs the flag: <code>picoCTF{4_d14m0nd_1n_7h3_r0ugh_ce4b5d5b}</code></p><h2 id=reversing-the-encryption>Reversing the Encryption<a hidden class=anchor aria-hidden=true href=#reversing-the-encryption>#</a></h2><p>Opening the file directly is too easy! Let&rsquo;s have some fun.</p><p>After executing <code>win()</code> on the server, we get this returned to us:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>0x70 0x69 0x63 0x6f 0x43 0x54 0x46 0x7b 0x34 0x5f 0x64 0x31 0x34 0x6d 0x30 0x6e 0x64 0x5f 0x31 0x6e 0x5f 0x37 0x68 0x33 0x5f 0x72 0x30 0x75 0x67 0x68 0x5f 0x63 0x65 0x34 0x62 0x35 0x64 0x35 0x62 0x7d
</span></span></code></pre></td></tr></table></div></div><p>Remember that <code>win()</code> function we discovered in the Python file? It converted each character of the flag into the hex representation of the character&rsquo;s unicode value (<code>ord(c)</code>):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>flag</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>str_flag</span> <span class=o>+=</span> <span class=nb>str</span><span class=p>(</span><span class=nb>hex</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>c</span><span class=p>)))</span> <span class=o>+</span> <span class=s1>&#39; &#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>We simply just need to reverse the operations provided in the above code snippet.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=c1># list comprehensions are super, super nice to know.</span>
</span></span><span class=line><span class=cl><span class=c1># https://www.programiz.com/python-programming/list-comprehension</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># hex string from win() output</span>
</span></span><span class=line><span class=cl><span class=n>starting_flag</span> <span class=o>=</span> <span class=s2>&#34;0x70 0x69 0x63 0x6f 0x43 0x54 0x46 0x7b 0x34 0x5f 0x64 0x31 0x34 0x6d 0x30 0x6e 0x64 0x5f 0x31 0x6e 0x5f 0x37 0x68 0x33 0x5f 0x72 0x30 0x75 0x67 0x68 0x5f 0x63 0x65 0x34 0x62 0x35 0x64 0x35 0x62 0x7d&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># split the string into individual hex codes</span>
</span></span><span class=line><span class=cl><span class=n>split_flag</span> <span class=o>=</span> <span class=n>starting_flag</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># convert each hex code back its original character</span>
</span></span><span class=line><span class=cl><span class=n>transformed_flag</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>word</span><span class=p>,</span> <span class=mi>16</span><span class=p>))</span> <span class=k>for</span> <span class=n>word</span> <span class=ow>in</span> <span class=n>split_flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>transformed_flag</span><span class=p>)</span> <span class=c1># picoCTF{4_d14m0nd_1n_7h3_r0ugh_ce4b5d5b}</span>
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/picoctf/>Picoctf</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/asm1/><span class=title>« Prev</span><br><span>PicoCTF: ASM1</span>
</a><a class=next href=http://localhost:1313/posts/picker2/><span class=title>Next »</span><br><span>PicoCTF: Picker II</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>0xtaxyneno</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>